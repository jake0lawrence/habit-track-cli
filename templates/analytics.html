<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>üìä Analytics ‚Äì habit-track</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="{{ url_for('static', filename='alpine.min.js') }}" defer></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
  <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
  <link rel="icon" type="image/svg+xml" href="/static/icons/icon.svg">
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/static/service-worker.js");
    }
  </script>
</head>
<body x-data="{ dark: false }" :class="{ 'dark': dark }">
  <header>
    <h1>üìà Analytics</h1>
    <div class="controls">
      <a href="/" class="button">‚Üê Back</a>
      <button @click="dark = !dark" class="theme-toggle" x-text="dark ? 'üåó Light Mode' : 'üåë Dark Mode'"></button>
    </div>
  </header>

  <section>
    {% for chart in chart_data %}
      <div class="chart-block">
        <h3>{{ chart.label }}</h3>
        <canvas id="chart-{{ loop.index }}"></canvas>
        <script>
          new Chart(document.getElementById("chart-{{ loop.index }}"), {
            type: 'bar',
            data: {
              labels: {{ labels | tojson }},
              datasets: [{
                label: '{{ chart.label }}',
                data: {{ chart.data | tojson }},
                backgroundColor: '#42b983'
              }]
            },
            options: {
              responsive: true,
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: function(ctx) {
                      return `Duration: ${ctx.raw} min`;
                    }
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  title: { display: true, text: 'Minutes' }
                }
              }
            }
          });
        </script>
      </div>
    {% endfor %}
  </section>
</body>
</html>
